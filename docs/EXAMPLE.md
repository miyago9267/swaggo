# Examples

## Basic Example

A simple Gin API with swaggo documentation.

### Project Structure

```text
my-api/
├── main.go
├── handlers/
│   └── user.go
├── models/
│   └── user.go
└── docs/           # Generated by swaggo
    ├── index.html
    ├── openapi.json
    └── openapi.yaml
```

### main.go

```go
package main

import (
    "github.com/gin-gonic/gin"
)

func main() {
    r := gin.Default()

    // Health check
    r.GET("/health", HealthCheck)

    // API routes
    api := r.Group("/api/v1")
    {
        users := api.Group("/users")
        users.GET("", ListUsers)
        users.GET("/:id", GetUser)
        users.POST("", CreateUser)
        users.PUT("/:id", UpdateUser)
        users.DELETE("/:id", DeleteUser)
    }

    // Swagger UI
    r.Static("/swagger", "./docs")

    r.Run(":8080")
}

// HealthCheck returns server health status
func HealthCheck(c *gin.Context) {
    c.JSON(200, gin.H{"status": "ok"})
}
```

### handlers/user.go

```go
package handlers

import (
    "net/http"
    "github.com/gin-gonic/gin"
)

// ListUsers returns all users with pagination
// Supports filtering by status and sorting by created_at
func ListUsers(c *gin.Context) {
    page := c.DefaultQuery("page", "1")
    limit := c.DefaultQuery("limit", "10")
    status := c.Query("status")

    users := []User{} // fetch from database
    c.JSON(http.StatusOK, users)
}

// GetUser retrieves a single user by ID
func GetUser(c *gin.Context) {
    id := c.Param("id")

    user := User{} // fetch from database
    c.JSON(http.StatusOK, user)
}

// CreateUser creates a new user
func CreateUser(c *gin.Context) {
    var req CreateUserRequest
    if err := c.ShouldBindJSON(&req); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
        return
    }

    user := User{} // create in database
    c.JSON(http.StatusCreated, user)
}

// UpdateUser updates an existing user
func UpdateUser(c *gin.Context) {
    id := c.Param("id")
    var req UpdateUserRequest
    if err := c.ShouldBindJSON(&req); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
        return
    }

    user := User{} // update in database
    c.JSON(http.StatusOK, user)
}

// DeleteUser removes a user
func DeleteUser(c *gin.Context) {
    id := c.Param("id")
    // delete from database
    c.JSON(http.StatusNoContent, nil)
}
```

### models/user.go

```go
package models

import "time"

type User struct {
    ID        int       `json:"id"`
    Name      string    `json:"name" binding:"required" example:"John Doe"`
    Email     string    `json:"email" binding:"required,email" example:"john@example.com"`
    Status    string    `json:"status" example:"active"`
    CreatedAt time.Time `json:"created_at"`
    UpdatedAt time.Time `json:"updated_at"`
}

type CreateUserRequest struct {
    Name     string `json:"name" binding:"required"`
    Email    string `json:"email" binding:"required,email"`
    Password string `json:"password" binding:"required,min=8"`
}

type UpdateUserRequest struct {
    Name   string `json:"name,omitempty"`
    Email  string `json:"email,omitempty"`
    Status string `json:"status,omitempty"`
}
```

### Generate Documentation

```bash
swaggo -dir . -title "User API" -version "1.0.0"
```

### Run and View

```bash
go run main.go
# Open http://localhost:8080/swagger in browser
```

## E-commerce API Example

A more complex example with multiple resources.

```go
package main

import "github.com/gin-gonic/gin"

func main() {
    r := gin.Default()

    api := r.Group("/api/v1")
    {
        // Products
        products := api.Group("/products")
        products.GET("", ListProducts)
        products.GET("/:id", GetProduct)
        products.POST("", CreateProduct)
        products.PUT("/:id", UpdateProduct)
        products.DELETE("/:id", DeleteProduct)
        products.GET("/:id/related", GetRelatedProducts)

        // Categories
        categories := api.Group("/categories")
        categories.GET("", ListCategories)
        categories.GET("/:id", GetCategory)
        categories.GET("/:id/products", GetCategoryProducts)

        // Orders
        orders := api.Group("/orders")
        orders.GET("", ListOrders)
        orders.GET("/:id", GetOrder)
        orders.POST("", CreateOrder)
        orders.PATCH("/:id/status", UpdateOrderStatus)
    }

    r.Static("/swagger", "./docs")
    r.Run(":8080")
}
```

Generated tags will be: `products`, `categories`, `orders`

## Using ShouldBindQuery

For complex query parameters, use `ShouldBindQuery`:

```go
type ListProductsQuery struct {
    Page     int    `form:"page" binding:"min=1"`
    Limit    int    `form:"limit" binding:"min=1,max=100"`
    Category string `form:"category"`
    MinPrice float64 `form:"min_price"`
    MaxPrice float64 `form:"max_price"`
    Sort     string `form:"sort" binding:"oneof=price name created_at"`
    Order    string `form:"order" binding:"oneof=asc desc"`
}

func ListProducts(c *gin.Context) {
    var query ListProductsQuery
    if err := c.ShouldBindQuery(&query); err != nil {
        c.JSON(400, gin.H{"error": err.Error()})
        return
    }
    // All query params are now documented with their types
}
```

## CI/CD Integration

```yaml
# GitHub Actions example
- name: Generate API docs
  run: |
    go install github.com/miyago9267/swaggo/cmd/swaggo@latest
    swaggo -d . -o ./docs -q

- name: Upload docs artifact
  uses: actions/upload-artifact@v3
  with:
    name: api-docs
    path: docs/
```
